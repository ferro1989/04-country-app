import { Component, inject, signal, effect, linkedSignal } from '@angular/core';
import { CountryList } from '../../components/country-list/country-list';
import { Region } from '../../interfaces/country.inteface';
import { CountryService } from '../../services/country';
import { rxResource } from '@angular/core/rxjs-interop';
import { tap, catchError, throwError, of } from 'rxjs';
import { DomSanitizer, SafeHtml } from '@angular/platform-browser';
import { Router, ActivatedRoute } from '@angular/router';

interface RegionWithSvg {
  name: Region;
  svg: SafeHtml;
}

@Component({
  selector: 'by-region-page',
  imports: [CountryList],
  templateUrl: './by-region.html',
})
export class ByRegionPage {
  private sanitizer = inject(DomSanitizer);

  regions: RegionWithSvg[] = [
    {
      name: 'Africa',
      svg: this.sanitizer
        .bypassSecurityTrustHtml(`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 100 100">
        <path
          fill="currentColor"
          d="M50 0C22.404 0 0 22.404 0 50s22.404 50 50 50c27.546 0 49.911-22.324 49.992-49.852A2 2 0 0 0 100 50a2 2 0 0 0-.006-.133C99.922 22.332 77.552 0 50 0m8.133 3.715q1.089.188 2.16.428c.744.632 1.378 1.1 1.492.345C78.807 8.877 92.068 22.557 95.88 39.805c-.754 4.286 1.668 9.599.52 12.896c-.44-1.527-.028-2.514-1.057-1.244c-1.988-3.484-1.707-9.881-5.237-11.277c-.922-3.45-2.77-3.022-6.373-2.319c-5.698-.938 3.37 1.85.715 4.72c-.631 3.07-3.419 5.951-6.285 7.64c-2.031 1.23-7.554 5.551-2.158 3.55c2.027.143 3.62-3.158 4.318.215c-1.128 4.01-2.56 8.157-5.978 10.807c-2.23 1.875-4.533 5.706-5.188 7.05c.633 1.028-.59 3.93.56 4.653c1.952 6.136-6.766 5.61-6.507 10.436c-2.856 2.63-5.653 6.488-10.227 6.78c-5.877 2.406-8.723-3.776-11.18-7.847c-4.435-3.129 1.089-6.92-1.113-10.554c-.843-3.638-6.001-5.565-4.236-9.561c1.691-3.345-4.58-1.954-5.174-5.295c-3.216-1.028-5.814 2.032-9.244.26c-5.192.534-5.812-6.2-8.455-8.988c-.234-4.29 1.25-8.417 2.463-12.54c.886-.992 1.63-1.81 2.059-2.47c2.334-3.3 4.604-4.53 5.76-6.254c1.202-.743 2.465-1.57 4.478-2.188c3.701.24 7.655-1.373 11.498-1.34c2.982.502-1.151 5.187 3.154 4.71c1.233.085 4.212 4.066 5.082 1.822c1.952-4.757 6.561 1.514 9.785-.344c3.395 1.846 6.1-2.769 3.655-4.64c.084 2.058-2.084 2.253-2.168.331c-2.45-1.396-5.916 3.206-8.155.293c-3.22-1.607-2.64-6.182-6.185-7.298c-.785-.494-1.195-.727-1.342-.768c-.637-.177 3.67 3.217 3.916 4.272c-1.842-.965-2.768 4.574-4.275 3.427c-2.164-1.814-1.357-2.458 1.156-2.83c1.498-.033-5.34-5.916-4.082-.55c-2.925 2.394-1-3.933.443-3.688c-3.008-.142-5.04.945-7.523 2.838c-1.042 2.085-3.052 3.516-5.235 3.683a208 208 0 0 1-1.593-.154c.1-.643-.25-1.182-1.282-1.28c.911-3.697 2.917-7.554 7.27-5.519c1.236-2.689-.806-4.02 1.885-5.24c-3.943 1.735.797-2.663-2.59-.963c-3.22-.579 3.218-3.092 3.453-4.398c4.277-1.797 1.634.412 2.115 2.81c-.039 3.274 2.711.074 4.647-.595c-.113-1.88 4.091-2.5.304-1.813c-2.66-2.556 4.421-4.252 5.54-5.828c3.731-2.17 9.334 1.973 10.75-.047c3.673.245.208-.055-.43-1.451m-19.395.65c-1.698.601-3.434 1.092-5.168 1.588a47 47 0 0 1 5.168-1.588m-3.57 1.854c1.476-.028 2.687.612-.215 1.42c-.617.152-1.272.323-1.902.091c-.34-1.064.969-1.49 2.117-1.511m14.113 3.758c-.352.051-.862.35-1.556 1.021c-.141 1.78-4.603 2.426-.725 2.025c2.366 1.137 3.809-3.271 2.281-3.046m21.49 8.728c-.87-.103-3.546 2.665-.209 3.77c3.04.926.122 5.477 4.79 4.252c.325-2.224-4.93-5.715-4.604-6.793c.401-.841.313-1.194.023-1.229m-13.539.873c-1.394 1.267-3.422 5.047.71 3.776c1.383-1.799 9.35 1.731 6.257-1.39c-2.528-1.885-5.233-.063-6.967-2.386M16.836 33.754c.302.045.662.35 1.105.51l-.232.718c-.38-.12-.91-.2-1.621-.238c.213-.83.454-1.034.748-.99m58.379.508c-1.243 1.102 3.05 3.946 4.082 4.62l.603-.425c1.28-2.21-4.006-1.836-4.685-4.195M62.678 37.29c-.102 1.847 1.911 3.514 2.736 5.342c1.312 2.636 2.846 5.938 4.703 7.236c.227.468 1.337 1.781 1.904 1.06c-1.389-1.925-1.457-4.374-3.6-5.898c-1.558-2.67-3.305-6.077-5.743-7.74m14.586 38.904c.96.065-.26 5.288-1.729 5.998c-1.282 1.526-3.303 5.895-5.687 4.81c.203-4.353 2.936-7.372 6.379-9.91c.477-.653.815-.913 1.037-.898"
          color="currentColor"
        />
      </svg>`),
    },
    {
      name: 'Americas',
      svg: this.sanitizer.bypassSecurityTrustHtml(
        `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 100 100">
        <path
          fill="currentColor"
          d="M50 0C22.404 0 0 22.404 0 50s22.404 50 50 50c27.546 0 49.911-22.324 49.992-49.852A2 2 0 0 0 100 50a2 2 0 0 0-.006-.133C99.922 22.332 77.552 0 50 0m0 3c.47 0 .934.021 1.4.035c3.72.913 6.655 1.695 7.508 5.315c3.96 2.452 7.876 4.644 10.621 8.25c-2.187.64-5.398-.424-4.92-3.032c-1.432 1.981-2.17 1.102-4.117 1.073c1.52.334 2.126 3.453 4.092 1.658c2.367 2.37-3.233 3.463-4.414 2.564c-3.022.28.594 3.349-3.033 3.121c-2.848 2.194-.726 5.881-4.75 6.909c-5.052 1.503 2.347 8.222-2.701 9.043c-.198-2.146-1.58-5.96-4.772-5.905c-3.043 2.139-9.71-1.542-10.271 4.44c-2.162 2.915.289 9.094 4.195 6.904c.742-2.105 6.972-4.895 5.39-.822c-.633 2.547-2.454 4.902 1.176 4.006c5.107.214 1.485 4.535 3.25 7.023c1.98 1.115 5.004.691 7.03.596c.518-3.387 5.9-3.183 6.232-3.315c.562-1.404 3.245.034 2.822 1.567c3.407-.074 2.618-2.08 5.807-.565c2.59-2.399.66 2.8 3.805 3.162c2.099 2.106 6.875.146 7.304 4.621c1.152 4.259 7.465 1.637 9.512 4.604c-.118 4.559-3.97 7.805-5.162 12.08c-1.9 4.756-7.426 5.848-9.92 10.066c-3.576 3.24-7.58 5.573-11.875 7.524c-.845.482-2.273 1.174-3.514 1.842a47 47 0 0 1-7.107 1.086c.464-1.247 2.653-2.73 3.07-4.014c1.6-3.48 6.445-8.865 2.186-11.883c-3.156-.554-4.111-3.439-5.617-5.58c-.952-2.87-5.13-5.028-2.811-7.736c-1.096-2.628 2.527-5.076 3.69-7.262c.36-2.336-1.94-6.07-3.202-2.97c-2.581-.797-5.73-2.474-6.652-5.184c-2.742-1.805-6.544-3.752-9.195-5.016c-3.306.153-6.324-2.243-8.735-4.24c-.234-3.476-2.303-7.77-3.972-10.01c1.513 2.335 1.282 8.624-1.153 3.38c-.7-2.38-1.053-5.489-1.197-8.142c-1.816-1.224-.973-6.548.805-8.767c1.985-1.55 3.598-6.143 3.496-6.916c-1.121.404.678-1.517 1.539-2.834A46.8 46.8 0 0 1 50 3m6.785.494a46.7 46.7 0 0 1 8.856 2.178c.043.11.087.222.148.35c4.282 4.875-4.403.474-6.209-.985c-.621-.531-1.66-1.082-2.795-1.543m-5.834 1.238c-1.098.056-1.974.6-.53 1.436c-.913 2.316-6.523-.88-6.587 2.582c1.738 1.693 5.434 1.518 6.861 3.225c-1.247-2.286 1.986-2.882 1.03-1.448c-.172 1.013 1.223-1.557-.192-.863c-.447-2.703-1.937-2.865 1.184-4.465c-.367-.359-1.107-.5-1.766-.467m2.485 30.301c1.597.073 2.983 3.4 3.92 3.436c.097-.307 1.185 3.26-.25 1.84c-2.252-.546-1.826-5.038-3.01-1.393c-2.968.075.761-3.487-1.797-3.332c.388-.41.768-.568 1.137-.55m-3.729 3.557c3.169.096 6.185 3.82 8.564 2.146c.895.68 1.127 2.356 3.891 1.94c3.393 1.103 1.534 2.464-.54 2.23c-.626-.093-.964 1.262-1.524.287c-1.344.154-4.462-.705-1.864-1.697c.01-2.245-4.72 1.662-4.742-1.28c-2.114-.751-3.54-2.205-5.299-.718c-.98-.772-3.473-.698-.699-2.283a3.8 3.8 0 0 1 2.213-.625m19.107 5.277c.37-.144 1.316 1.79 1.65.387c.646 1.7 2.371 6.354.093 6.605c1.183-2.5-.758-4.772-1.891-6.494c.01-.32.063-.465.148-.498"
          color="currentColor"
        />
      </svg>`
      ),
    },
    {
      name: 'Asia',
      svg: this.sanitizer.bypassSecurityTrustHtml(
        `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 100 100">
        <path
          fill="currentColor"
          d="M50 0C22.404 0 0 22.404 0 50s22.404 50 50 50c27.546 0 49.911-22.324 49.992-49.852A2 2 0 0 0 100 50a2 2 0 0 0-.006-.133C99.922 22.332 77.552 0 50 0m-1.24 3.238c1.317-.098 1.77.243-1.053.899c-3.886 1.145 2.065 2.421 2.576.195c2.55-.085 2.411-.18 3.06-.748c1.26.05 1.675-.1 1.663-.316c12.374 1.307 23.303 7.41 30.91 16.416c.88 2.14 1.49 4.31 3.088 5.964c.032.247 1.264 2.094.621.157a4.4 4.4 0 0 0-.012-1.098a47 47 0 0 1 2.088 3.607a2.8 2.8 0 0 1-.203.663c1.88 6.248-2.697-4.65-2.037-.041c-1.523-2.784-3.294-5.467-4.861-4.899c-1.733.548 3.468 1.264 1.818 3.445c3.044 3.05 4.62 7.417 3.41 11.694c-1.854 2.38-2.744 3.865-3.117 6.633c-1.548-.614-.352-5.383-2.4-1.121c3.012 2.95 4.997 9.495.037 11.714c.207-1.894-4.42-5.448-3.739-.613c1.509 2.507 4.6 5.1 4.141 8.982c-.887 1.78 4.527 1.167.814 2.881c-.532.634-.435 2.565.78 1.506c1.406.19 2.762-1.642 4.408-.996c-2.219 1.806 4.159-.758 1.781-2.598c.143-2.733 1.137-7.026-.617-2.113c.63 3.992-4.078 3.01-4.707 2.078c.816-1.342-1.149-8.521.467-4.783c2.963.533 4.427-6.972 5.156-10.133c.895-2.422-1.636-7.717-.05-8.492c.954 3.63 2.83 4.912 3.22 8.973c.544 2.5-.283 3.565-1.238 3.045c-1.298 1.729-3.221 7.93.236 4.34c2.2-3.902-.808 2.373.023 1.667c.963 1.336.992-3.92 1.565-4.005a47 47 0 0 1-1.287 6.386c-.021.03-.037.045-.059.077c-1.041-2.905-.295 3.813-2.015 2.904c-.246 1.288.324 1.064.941.607a47 47 0 0 1-1.313 3.194c-1.993 1.348-5.057 1.234-7.214 1.953c-2.379.131-4.05-3.147-5.625-2.873c-1.656-2.371-1.002-4.627-3.407-6.907c1.102-3.563 6.97 4.754 4.418-1.123c-3.159-2.524-1.856-7.003-2.976-10.423c-2.15 1.458-3.423.573-3.237-2.022c-1.405-2.619-3.791-4.646-6.392-1.967c-1.579 2.77-4.48 4.847-6.352 7.04c-1.003 3.656 2.302 6.157 1.631 9.529c-3.267 2.78-1.582-5.566-4.506-1.584c-3.096-1.863-3.5-6.615-5.226-9.713c-1.187-2.207.538-5.486-2.764-4.23c-3.034-.288-.966-5.479-2.756-3.456c-2.702-2.627-8.368-.883-10.99-2.201c2.446 1.5 4.267 4.481 1.164 6.397c-2.107 2.87-5.965 4.06-9.307 5.017c-1.435 1.107-8.658 1.899-3.375 3.143c2.144-.081 3.19-.691 5.057-.387c.546 2.996-2.19 5.479-3.574 8.127c-2.144 2.136-4.935 3.37-6.51 5.871c-.741 2.535.805 5.57 1.777 8.057c2.667 3.726-4.654 3.133-1.394 6.322c.663 1.592-.652 1.28-.326 3.082C10.03 78.359 3 65.01 3 50c0-9.59 2.872-18.5 7.795-25.932c.71.872 2.423 1.982.637 2.512c-1.329 1.584.252 7.323 2.232 3.25c1.808 1.571 4.378 3.644 7.086 2.416c1.714-2.108 2.398-5.107.318-2.246c-1.535.046.601-2.722-2.066-1.66c-2.782 1.433-4.43-.52-2.986-3.608c-.048-3.169-5.455 5.659-3.096-.168c2.863-.32 1.9-5.538-.043-1.128c-2.023.43 2.942-3.687 2.02-3.557c-.205.029-.723.282-1.647.824c5.895-7.387 13.967-12.954 23.254-15.73c1.739.066 3.323.672 4.04 1.41c1.183-1.135 7.699.147 4.077-1.41c.638-1.099 2.821-1.636 4.139-1.735M24.469 19.895c-2.674 1.167-4.311 4.556 0 3.064c1.428.151 2.643 2.027 4.19.902c.28-2.873-4.301-2.355-4.19-3.966m12.511.318c-1.594-.057-5.271 3.037-2.236 5.293c-3.272 1.98-.178 4.172 2.295 3.289c.278-2.717-2.885-6.961.604-7.99c-.038-.398-.295-.579-.663-.592m-24.888 1.996c.009.156-.092.338-.406.572c.135-.19.268-.384.406-.572m19.693 14.338c-2.963-.06 1.922 3.833 1.596 5.267c.629.154 1.241-.083 1.818-.29c2.171-1.622-3.849-2.362-3.414-4.977m-12.517.71c-.314.067-.498.735-.08 2.155c.778 3.914.359 8.243 2.644 11.358c.265.498 1.092 2.057 1.033.318c-.625-3.819-2.063-7.405-2.763-11.414c.183-1.59-.431-2.5-.834-2.416M93.67 49.917c-.202.061-.402.69-.51 2.225c-1.084.508-.54 4.734.518 2.968c1.029-1.432.584-4.95.078-5.185a.12.12 0 0 0-.086-.008M88.129 77.48a47 47 0 0 1-3.742 4.56c1.09-1.642 2.26-3.219 3.742-4.56m-58.404 1.397c1.62-.194 2.479 5.094 1.146 6.947c.383 2.269-1.766 3.022-3.035 1.242c-1.723-2.168-3.27-6.71.662-7.068c.437-.738.853-1.076 1.227-1.121"
          color="currentColor"
        />
      </svg>`
      ),
    },
    {
      name: 'Europe',
      svg: this.sanitizer.bypassSecurityTrustHtml(
        `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 100 100">
        <path
          fill="currentColor"
          d="M50 0C22.404 0 0 22.404 0 50s22.404 50 50 50c27.546 0 49.911-22.324 49.992-49.852A2 2 0 0 0 100 50a2 2 0 0 0-.006-.133C99.922 22.332 77.552 0 50 0m0 3c2.776 0 5.49.254 8.133.715c.638 1.396 4.103 1.696.43 1.451c-1.416 2.02-7.019-2.123-10.75.047c-1.119 1.576-8.2 3.272-5.54 5.828c3.787-.687-.417-.067-.304 1.813c-1.936.67-4.686 3.87-4.647.595c-.48-2.398 2.162-4.607-2.115-2.81c-.235 1.306-6.674 3.82-3.453 4.398c3.387-1.7-1.353 2.698 2.59.963c-2.691 1.22-.65 2.551-1.885 5.24c-4.353-2.035-6.359 1.822-7.27 5.52c1.032.097 1.382.636 1.282 1.28c.522.051 1.26.123 1.593.153c2.183-.167 4.193-1.598 5.235-3.683c2.483-1.893 4.515-2.98 7.523-2.838c-1.443-.245-3.368 6.082-.443 3.687c-1.258-5.365 5.58.518 4.082.551c-2.513.372-3.32 1.016-1.156 2.83c1.507 1.147 2.433-4.392 4.275-3.427c-.245-1.055-4.553-4.45-3.916-4.272c.147.041.557.274 1.342.768c3.546 1.116 2.965 5.69 6.185 7.298c2.24 2.913 5.706-1.689 8.155-.293c.084 1.922 2.252 1.727 2.168-.332c2.445 1.872-.26 6.487-3.655 4.641c-3.224 1.858-7.833-4.413-9.785.344c-.87 2.244-3.849-1.737-5.082-1.822c-4.305.477-.172-4.208-3.154-4.71c-3.843-.033-7.797 1.58-11.498 1.34c-2.013.619-3.276 1.445-4.479 2.188c-1.155 1.724-3.425 2.954-5.76 6.254c-.428.66-1.172 1.478-2.058 2.47c-1.212 4.123-2.697 8.25-2.463 12.54c2.643 2.788 3.263 9.522 8.455 8.988c3.43 1.772 6.028-1.288 9.244-.26c.593 3.341 6.865 1.95 5.174 5.295c-1.765 3.996 3.393 5.923 4.236 9.56c2.202 3.636-3.322 7.426 1.114 10.555c2.456 4.07 5.302 10.253 11.18 7.848c4.573-.293 7.37-4.15 10.226-6.781c-.259-4.826 8.459-4.3 6.508-10.436c-1.15-.724.072-3.625-.56-4.652c.654-1.345 2.958-5.176 5.187-7.051c3.417-2.65 4.85-6.796 5.978-10.807c-.698-3.373-2.29-.072-4.318-.215c-5.396 2.001.127-2.32 2.158-3.55c2.866-1.689 5.654-4.57 6.285-7.64c2.656-2.87-6.413-5.658-.715-4.72c3.603-.703 5.451-1.131 6.373 2.319c3.53 1.396 3.249 7.793 5.237 11.277c1.03-1.27.618-.283 1.056 1.244c1.15-3.297-1.273-8.61-.52-12.896A47.2 47.2 0 0 1 97 50c0 25.975-21.025 47-47 47S3 75.975 3 50C3 29.806 15.71 12.61 33.57 5.953c1.734-.496 3.47-.987 5.168-1.588A47.2 47.2 0 0 1 50 3m10.293 1.143c.499.11 1 .218 1.492.345c-.114.755-.748.287-1.492-.345M35.168 6.219c-1.148.021-2.457.447-2.117 1.511c.63.232 1.285.06 1.902-.091c2.902-.808 1.691-1.448.215-1.42m14.113 3.758c1.528-.225.085 4.183-2.281 3.046c-3.878.401.584-.245.725-2.025c.694-.67 1.204-.97 1.556-1.021m21.49 8.728c.29.035.378.388-.023 1.229c-.327 1.078 4.93 4.569 4.604 6.793c-4.668 1.225-1.75-3.326-4.79-4.252c-3.337-1.105-.66-3.873.21-3.77m-13.539.873c1.734 2.323 4.44.501 6.967 2.387c3.092 3.12-4.874-.41-6.258 1.389c-4.131 1.271-2.103-2.51-.709-3.776M16.836 33.754c-.294-.044-.535.16-.748.99c.71.037 1.24.117 1.621.238l.232-.718c-.443-.16-.803-.465-1.105-.51m58.379.508c.68 2.359 5.965 1.985 4.685 4.195l-.603.426c-1.032-.675-5.325-3.52-4.082-4.621M62.678 37.29c2.438 1.663 4.185 5.07 5.744 7.74c2.142 1.524 2.21 3.973 3.6 5.899c-.568.72-1.678-.593-1.905-1.06c-1.857-1.299-3.39-4.6-4.703-7.237c-.825-1.828-2.838-3.495-2.736-5.342m14.586 38.904c-.222-.015-.56.245-1.037.899c-3.443 2.537-6.176 5.556-6.38 9.91c2.385 1.084 4.406-3.285 5.688-4.81c1.469-.711 2.689-5.934 1.729-5.999"
        />
      </svg>`
      ),
    },
    {
      name: 'Oceania',
      svg: this.sanitizer.bypassSecurityTrustHtml(
        `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 100 100">
        <path
          fill="currentColor"
          d="M50 0C22.404 0 0 22.404 0 50s22.404 50 50 50c27.546 0 49.911-22.324 49.992-49.852A2 2 0 0 0 100 50a2 2 0 0 0-.006-.133C99.922 22.332 77.552 0 50 0m0 3c.45 0 .893.02 1.34.033c.793.171 1.487.35 1.803.551c1.168-.301 1.449-.33 1.386-.363a46.7 46.7 0 0 1 16.33 4.654c-.002.146 0 .298.024.488c-1.78.44 2.292 3.853.664 5.975c-.215 2.927-3.672 6.482-5.305 6.308c2.106 2.8 1.73 7.738-1.935 7.346c-2.745.097-3.97 2.857-5.922 4.326c.882-2.698-1.625-2.879-1.315-4.865c-1.74 1.232-1.559 2.02-3.074-.187c1.54-1.132-.804-3.925-1.394-4.22c-1.377.775-2.816.375-.676 2.01c-5.433 1.61 2.262 5.31-.758 8.8c-1.87 4.43-6.368 6.967-10.965 7.517c1.33 3.056-4.718 4.747-2.385.975c1.453-2.924-5.702 1.257-1.672 2.959c2.434 1.993 3.183 7.05-.529 8.152c-2.1 2.407-3.03 1.105-4.525-1.027c-1.631-4.668-4.605.216-2.315 2.73c3.193 2.524 3.273 5.527 4.325 8.781c-.817 2.274 5.691 2.774 2.627 3.95c-4.103.08 2.743 4.28 3.552 2.363c2.302 1.251 7.29.95 4.793 2.215c2.762.326 7.503.89 4.223-2.81c-1.177-1.886-.288-5.455 2.355-6.962c2.21 2.348 5.624-3.12 4.774.582c-1.773 1.41-3.035 2.702.246 2.819c1.322 2.895 4.89.305 4.238-1.657c1.906-.537 5.86.084 7.682.776c3.017-.003 7.963.658 9.248 2.76c1.038-1.26 4.406-.396 3.447-2.711c-1.775-.645-.873-3.02.727-.819c2.169.144 3.496 3.788 6.218 3.746c2.07 3.672-2.489 1.309-1.878.426c-1.556 3.55-2.174-4.842-3.733-1.539c-1.715.925-5.707 3.63-2.219 3.486c2.287-.837-.463 4.67-2.982 1.825c-3.158-3.537-5.252 3.216-2.356 4.168c.092 2.37 2.104 3.781 3.05 5.738c2.493 2.484-3.174 6.46-5.2 8.445c-.97.41-1.96 1.425-2.896 2.242c-.822.364-1.653.709-2.498 1.026c-.31-.156-.597-.474-.854-1.035c-2.702-.134-4.44-2.063-7.574-2.047c-4.196.321-9.163 3.08-12.95 1.185c.314-2.712-5.438-7.3.12-8.537c4.317.302 6.384-3.146 9.478-5.273c2.101-1.113 5.2 1.314 5.127-2.067c.137-2.08 6.326-1.06 7.09-.924c-.853 2.723-1.455 3.85 2.164 3.579c.595 1.973 3.558-5.84 1.897-5.89c-1.389-1.233-5.358.297-2.27-2.177c-1.448-3.443-6.653-.216-6.768-4.26c-2.788-.3 2.598 4.175-1.654 1.907c-3.718 1.506-5.55-1.757-8.715-1.686c1.672 1.658 3.686 5.446.016 3.996c-2.09-3.347-1.48 1.086-.713 1.942c.48-2.485.632 1.657 2.834-.215c1.754-1.514 7.636.76 3.686.36c.455.298-7.339 5.269-4.569 1.4c.02-1.2-3.871.404-1.254.935c-2.814.458-6.039-1.864-9.404-1.771c-3.844-.434-7.981-.952-10.57-4.094c-1.997-2.894-5.106-2.259-5.563-6.252c-.678-1.97-3.021-4.515-2.771-6.574c2.727-.3 6.351 6.6 4.537 1.109c-1.916-2.375-2.5-5.982-1.485-8.828c.292-2.892-.884-2.858-2.763-2.469c-.496-2.255.025-8.263-4.235-6.55c-2.408 2.58-6.721 4.024-6.806 7.92c-1.13 1.527 2.28 8.444-1.065 6.447c.221-2.915-.325-2.296-1.523-2.288c-1.223-4.267-1.159-8.925-.631-13.212c-2.183-2.045 1.318-4.697-2.73-5.225c-.917-1.825-.732 3.813-2.307 5.63C9.225 18.367 27.798 3 50 3m16.893 4.666a1.1 1.1 0 0 0-.297.01c-.45.078-.736.46-.35 1.185c-2.678-1.12-9.506 1.467-3.803 2.918c-.215-1.487 5.215 4.114 2.754 3.608c1.118 1.423 1.301 1.957.399 1.86c.411.92 1.577 1.23 2.46.849c4.53-1.818 2.31-5.986-.222-8.446c.624-1.213-.219-1.915-.941-1.984m11.353 4.758c.24.18.47.372.707.556c-.836-.113-.886-.301-.707-.556m-15.04 1.127c-.118-.041-.082.411.23 1.656c-.218 3.696-3.41 4.678-5.706 5.678c-3.095 2.152 1.226 3.506.508 6.449c-.283.53.67.543.69.125c1.56-2.459 3.958-1.42 5.18-3.29c2.154-.22-.428-3.844.97-5.067c.206-.87-1.522-5.428-1.873-5.551M50.968 36.979c.653.043 1.015.74.156 2.47c-.387.783.404 1.88-1.549 1c-1.594-1.8.304-3.543 1.393-3.47m-.305 6.334c.995-.1 1.986 1.122 1.574 3.248c-2.439 1.84 2.884 1.893 2.616 3.83c1.803 1.804 3.677 9-.61 8.324c-1.788-4.104-2.89 1.323-5.765 1.162c-3.038.952 1.333 3.257-.733 4.45c-1.806.188-1.786 5.802-3.18 5.015c-.996-.923-5.986-.173-6.64-2.871c-2.272-1.358-.445-5.155-1.918-7.37c1.44.253 2.242 5.51 4.047 1.762c4.052-.948 5.242-5.247 7.795-7.822c2.565-2.083.887-4.085 1.15-6.898c.116-1.875.89-2.753 1.664-2.83m-.516 8.478c-.736 2.329-6.266 4.8-1.642 6.72l.748.005l.236-.22c2.508-.887 1.932-3.966 1.912-5.882c-1.192.375-.857.568-1.254-.623m8.713 10.14c.547.057.778.853-.068 2.76c.586 1.145-.98 3.022-1.752 1.399c-.875-2.29.91-4.252 1.82-4.158"
          color="currentColor"
        />
      </svg>`
      ),
    },
    {
      name: 'Antarctic',
      svg: this.sanitizer.bypassSecurityTrustHtml(
        `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 100 100">
        <path
          fill="currentColor"
          d="M50 0C22.404 0 0 22.404 0 50s22.404 50 50 50c27.546 0 49.911-22.324 49.992-49.852A2 2 0 0 0 100 50a2 2 0 0 0-.006-.133C99.922 22.332 77.552 0 50 0m-5.492 3.328c-1.833.901-3.595 1.954-5.363 2.713c-.996 2.1-4.684 2.981-4.926 6.07c-1.948 1.117 1.792 1.513-.4 3.588c-.233 3.345 6.36.31 2.306 3.211c-3.105 2.288-8.25-.148-8.346-3.912c-1.016-1.889-.584-4.209-.629-6.076a46.7 46.7 0 0 1 17.358-5.594m-2.1 18.6c.178.032-.036.418-1.084 1.402c-.264.838 4.275-2.51 2.28.559c-2.873 1.037-.586 2.744-.297 5.23c1.346 2.85 1.275 5.491 4.722 6.285c4.51 3.426 6.312-3.533 10.38-2.927c3.763-.537 7.1 1.027 9.128 4.433c2.468 2.102 2.452 5.868 4.895 8.063c-.574 2.9 3.198 4.893 3.07 7.746c-.914 3.451-4.483 6.516-5.594 8.98c1.802 3.831-3.053 5.833-3.037 8.406c-1.78 2.548-4.562.734-6.371 3.446c-3.521-.178-6.242 1.592-9.37 2.015c.122.422-1.292-.473-1.157-.107c-3.805-1.176-7.438-2.96-9.717-6.383c-3.885-2.828 1.364-3.54 2.072-5.082c2.87-1.74-3.714-3.803-3.369-6.889c-3.599-1.165-5.888-4.957-6.906-8.455c-1.05-2.14 2.368-5.4 3.232-7.123c-4.179.938-1.47-4.873 1.662-5.025c1.553-.094 1.9-2.605 2.496-2.912c-2.433-.2-1.157-4.358.797-3.936c-2.742-1.686 1.1-4.094.045-6.11c.44-.748 1.827-1.67 2.123-1.616M90.4 25.97a46.7 46.7 0 0 1 4.778 11.066c-2.45-3.225-5.302-6.909-4.785-10.867c.008-.068.001-.132.007-.2M21.504 83.1c.365-.02.922.072 1.726.304c2.06 1.201 6.294-.586 6.96 1.666c-.143 2.898-7.281-1.773-6.364.389c-1.782-.188 1.11 3.147-.941 1.59c-.953-1.714-2.962-3.867-1.381-3.95m20.736 8.105q.124-.007.254.008c1.523.175 3.591 2.544.072 1.537c-.382.266-.86.726-1.234.107c-.095-1.181.335-1.615.908-1.652m25.133 1.057c.214.476.468.837.748 1.117A46.9 46.9 0 0 1 50 97c-4.514 0-8.873-.648-13.004-1.834c.746-1.562 5.875-2.168 7.46-1.443c2.178-.502 6.067 2.213 9.052 2.398c4.947.22 9.278-2.744 13.865-3.86"
          color="currentColor"
        />
      </svg>`
      ),
    },
  ];

  router = inject(Router);
  activatedRoute = inject(ActivatedRoute);
  queryParams = this.activatedRoute.snapshot.queryParamMap.get('region') ?? '';

  // Señal que contiene la región seleccionada basada en el query param 'region'
  // Si no hay región en los query params, selecciona 'Americas' por defecto
  selectedRegion = linkedSignal<RegionWithSvg>(() => {
    const regionName = this.queryParams;
    return this.regions.find(r => r.name === regionName) || this.regions[1];
  });
  countryService = inject(CountryService);

  countryResource = rxResource({
    params: () => ({ region: this.selectedRegion() }),
    stream: ({ params }) => {
      if (!params.region) return of([]);

      //Actualizar la URL con el query param 'query' igual al nombre de la region seleccionada
      this.router.navigate(['country/by-region'], {
        queryParams: { region: params.region.name }
      });

      return this.countryService.searchByRegion(params.region.name)
    },
  });
}
